-- zestaw 1

-- 1
select o.imie, o.nazwisko, e.email, a.miasto from osoby o join emaile e on o.id_osoby = e.id_osoby join adresy a on o.id_osoby = a.id_osoby;

-- 2
select o.imie, o.nazwisko, z.produkt, z.kwota from osoby o join zamowienia z on o.id_osoby = z.id_osoby where z.kwota > 2000;

-- 3
select avg(kwota) as srednia_kwota from zamowienia;

-- 4
select a.miasto, count(a.id_osoby) as liczba_osob from adresy a group by a.miasto;

-- 5
select o.imie, o.nazwisko from osoby o left join zamowienia z on o.id_osoby = z.id_osoby where z.id_osoby is null;

-- 6
select o.imie, o.nazwisko, sum(z.kwota) as suma_zamowien from osoby o join zamowienia z on o.id_osoby = z.id_osoby group by o.id_osoby order by suma_zamowien desc limit 3;

-- 7
select o.imie, o.nazwisko, count(z.id_zamowienia) as liczba_zamowien from osoby o join zamowienia z on o.id_osoby = z.id_osoby group by o.id_osoby having count(z.id_zamowienia) > 1;


-- zestaw 2

-- 1
select o.imie, o.nazwisko from osoby o join zamowienia z on o.id_osoby = z.id_osoby where year(z.data_zamowienia) = 2024 group by o.id_osoby;

-- 2
select o.imie, o.nazwisko, e.email from osoby o right join emaile e on o.id_osoby = e.id_osoby;

-- 3
select o.imie, o.nazwisko, t.numer, t.typ from osoby o right join telefony t on o.id_osoby = t.id_osoby;

-- 4
select o.imie, o.nazwisko, a.miasto, t.numer, e.email, z.data_zamowienia from osoby o left join adresy a on o.id_osoby = a.id_osoby left join telefony t on o.id_osoby = t.id_osoby left join emaile e on o.id_osoby = e.id_osoby left join zamowienia z on o.id_osoby = z.id_osoby;

-- 5
select z.produkt, z.kwota, a.miasto, a.ulica from zamowienia z left join adresy a on z.id_osoby = a.id_osoby;

-- 6
select o.imie, o.nazwisko from osoby o left join emaile e on o.id_osoby = e.id_osoby where e.id_osoby is null;

-- 7
select o.imie, o.nazwisko, z.produkt, z.kwota from osoby o left join zamowienia z on o.id_osoby = z.id_osoby;
